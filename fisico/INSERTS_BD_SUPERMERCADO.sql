USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;

INSERT INTO SUPERMERCADO(SUP_CNPJ,
						 SUP_RAZAO_SOCIAL,
						 SUP_TELEFONE,
						 SUP_EMAIL,
						 SUP_ENDERECO_LOGRADOURO, 
						 SUP_ENDERECO_NUMERO ,
						 SUP_ENDERECO_CIDADE,
						 SUP_ENDERECO_ESTADO)
VALUES              	("12345678",
						"SUPERMERCADO GRICK",
						"123443847",
						"GRICK@EMAIL.COM",
						"GRICK STREET",
						"1000",
						"TAMBACITY",
						"SP");

INSERT INTO SUPERMERCADO 	(SUP_CNPJ,
							SUP_RAZAO_SOCIAL,
							SUP_TELEFONE,
							SUP_EMAIL,
							SUP_ENDERECO_LOGRADOURO,
							SUP_ENDERECO_NUMERO,
							SUP_ENDERECO_CIDADE, 
							SUP_ENDERECO_ESTADO)
VALUES 						("87654321",
							"SUPERMERCADO BOLTON",
							"(11)2345-6789",
							"BOLTON@EMAIL.COM",
							"RUA BOLTON",
							"200",
							"CAMPINAS",
							"SP");

INSERT INTO SUPERMERCADO (SUP_CNPJ,
						  SUP_RAZAO_SOCIAL,
                          SUP_TELEFONE, 
						  SUP_EMAIL,
						  SUP_ENDERECO_LOGRADOURO,
						  SUP_ENDERECO_NUMERO,
						  SUP_ENDERECO_CIDADE,
						  SUP_ENDERECO_ESTADO)
VALUES                    ("23456789",
						   "SUPERMERCADO SOLAR",
						   "(21)3456-7890",
						   "SOLAR@EMAIL.COM",
						   "AV. DO SOL",
						   "300",
						   "RIO DE JANEIRO",
						   "RJ");

INSERT INTO SUPERMERCADO (SUP_CNPJ,
						 SUP_RAZAO_SOCIAL,
						 SUP_TELEFONE, 
						 SUP_EMAIL,
						 SUP_ENDERECO_LOGRADOURO,
						 SUP_ENDERECO_NUMERO,
						 SUP_ENDERECO_CIDADE,
						 SUP_ENDERECO_ESTADO)
VALUES					 ("34567890",
						  "SUPERMERCADO LUZES",
						  "(31)4567-8901",
						  "LUZES@EMAIL.COM",
						  "RUA DA LUZ",
						  "400",
						  "BELO HORIZONTE",
						  "MG");

INSERT INTO SUPERMERCADO (SUP_CNPJ, 
						 SUP_RAZAO_SOCIAL, 
						 SUP_TELEFONE,
						 SUP_EMAIL,
						 SUP_ENDERECO_LOGRADOURO,
						 SUP_ENDERECO_NUMERO, 
						 SUP_ENDERECO_CIDADE,
						 SUP_ENDERECO_ESTADO)
VALUES 					("45678901",
						"SUPERMERCADO FLORES",
						"(41)5678-9012",
						"FLORES@EMAIL.COM",
						"ALAMEDA DAS FLORES",
						"500",
						"CURITIBA",
						"PR");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS,
					 PRO_NOME,
					 PRO_PESO,
					 PRO_QUANTIDADE, 
					 PRO_PRECO,
					 PRO_DATA_VALIDADE)
VALUES              ("233554656", 
					"ARROZ 5KG",
					 5.0, 
					 500,
					 26.90,
					 "2025-12-25");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS,
					 PRO_NOME, 
					 PRO_PESO,
					 PRO_QUANTIDADE,
					 PRO_PRECO,
					 PRO_DATA_VALIDADE)
VALUES 				("987654321",
					"FEIJAO 1KG",
					1.0,
					300,
					9.50, 
					"2024-11-30");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, 
					PRO_NOME, 
					PRO_PESO,
					PRO_QUANTIDADE,
					PRO_PRECO,
					PRO_DATA_VALIDADE)
VALUES              ("123123123", 
					"AÇUCAR 2KG",
					 2.0,
					 200,
					 8.75, 
					 "2025-06-15");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS,
					 PRO_NOME,
					 PRO_PESO,
					 PRO_QUANTIDADE,
					 PRO_PRECO,
					 PRO_DATA_VALIDADE)
VALUES 				("456456456",
					"MACARRAO 500G",
					0.5,
					400,
					4.20, 
					"2025-10-10");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, 
					PRO_NOME,
					PRO_PESO,
					PRO_QUANTIDADE,
					PRO_PRECO,
					PRO_DATA_VALIDADE)
VALUES 				("789789789", 
					"OLEO 900ML",
					 0.9,
					 350,
					 7.80,
					 "2025-08-20");

INSERT INTO CONSUMIDOR ( CON_CPF,
						 CON_NOME,
						 CON_TELEFONE,
						 CON_EMAIL)
VALUES                 ("54951633858", 
						"JULIA SAVELLA",
						"19996340870",
						"JULIA@GMAIL.COM");

INSERT INTO CONSUMIDOR  (CON_CPF, 
						CON_NOME,
						CON_TELEFONE,
						CON_EMAIL)
VALUES 				    ("12345678901",
						"MARCOS SILVA",
						"11987654321",
						"MARCOS.SILVA@EMAIL.COM");

INSERT INTO CONSUMIDOR   (CON_CPF,
						 CON_NOME, 
						 CON_TELEFONE,
						 CON_EMAIL)
VALUES				     ("23456789012", 
						 "ANA PEREIRA",
						 "21976543210",
						 "ANA.PEREIRA@EMAIL.COM");

INSERT INTO CONSUMIDOR (CON_CPF,
						 CON_NOME,
						 CON_TELEFONE, 
						 CON_EMAIL)
VALUES                 ("34567890123", 
						"ROBERTO SOUZA", 
						"31965432109",
						"ROBERTO.SOUZA@EMAIL.COM");

INSERT INTO CONSUMIDOR  (CON_CPF,
						 CON_NOME,
						 CON_TELEFONE, 
						 CON_EMAIL)
VALUES                  ("45678901234",
						"CARLA COSTA",
						"41954321098", 
						"CARLA.COSTA@EMAIL.COM");

INSERT INTO FUNCIONARIO (FUN_CPF, 
						 FUN_NOME,
						 FUN_DATA_NASCIMENTO,
						 FUN_TELEFONE,
						 FUN_EMAIL,
						 FUN_CARTEIRA_TRABALHO,
						 FUN_BANCO_AGENCIA,
						 FUN_BANCO_CONTA,
						 FUN_DATA_ADMISSAO,
						 FUN_JORNADA_TRABALHO,
						 FK_SUP_CNPJ)
VALUES 				   ("13132343533", 
						"JOSE VANDERLEI", 
						"1985-03-12", 
						"193938277372", 
						"ZE@GMAIL.COM", 
						"CARTEIRA_ZE_VANDERLEI_.PDF", 
						"1234", 
						"56789", 
						"2020-01-15", 
						"44 HORAS",
						"12345678");

INSERT INTO FUNCIONARIO (FUN_CPF,
						 FUN_NOME,
						 FUN_DATA_NASCIMENTO,
						 FUN_TELEFONE,
						 FUN_EMAIL,
						 FUN_CARTEIRA_TRABALHO,
						 FUN_BANCO_AGENCIA,
						 FUN_BANCO_CONTA,
						 FUN_DATA_ADMISSAO,
						 FUN_JORNADA_TRABALHO,
						 FK_SUP_CNPJ)
VALUES                  ("22234567890",
						 "MARIA ALVES",
						 "1990-07-22",
						 "11987654321",
						 "MARIA.ALVES@EMAIL.COM",
						 "CARTEIRA_MARIA_ALVES_.PDF",
						 "4321",
						 "98765",
						 "2021-06-01",
						 "44 HORAS",
						 "87654321");

INSERT INTO FUNCIONARIO (FUN_CPF,
						 FUN_NOME,
						 FUN_DATA_NASCIMENTO,
						 FUN_TELEFONE,
						 FUN_EMAIL,
						 FUN_CARTEIRA_TRABALHO,
						 FUN_BANCO_AGENCIA,
						 FUN_BANCO_CONTA,
						 FUN_DATA_ADMISSAO,
						 FUN_JORNADA_TRABALHO,
						 FK_SUP_CNPJ)
VALUES 					("33345678901",
						"CARLOS PEREIRA",
						"1988-11-05",
						"21976543210", 
						"CARLOS.PEREIRA@EMAIL.COM",
						"CARTEIRA_CARLOS_PEREIRA_.PDF",
						"5678",
						"12345",
						"2019-09-10",
						"44 HORAS",
						"23456789");

INSERT INTO FUNCIONARIO (FUN_CPF,
						 FUN_NOME,
						 FUN_DATA_NASCIMENTO,
						 FUN_TELEFONE,
						 FUN_EMAIL,
						 FUN_CARTEIRA_TRABALHO,
						 FUN_BANCO_AGENCIA,
						 FUN_BANCO_CONTA,
						 FUN_DATA_ADMISSAO,
						 FUN_JORNADA_TRABALHO,
						 FK_SUP_CNPJ)
VALUES                  ("44456789012",
						 "PAULO SOUZA",
						 "1992-02-17", 
						 "31965432109",
						 "PAULO.SOUZA@EMAIL.COM",
						 "CARTEIRA_PAULO_SOUZA_.PDF",
						 "8765",
						 "43210",
						 "2022-03-15",
						 "44 HORAS",
						 "34567890");

INSERT INTO FUNCIONARIO (FUN_CPF,
						FUN_NOME,
						FUN_DATA_NASCIMENTO,
						FUN_TELEFONE,
						FUN_EMAIL,
						FUN_CARTEIRA_TRABALHO,
						FUN_BANCO_AGENCIA,
						FUN_BANCO_CONTA,
						FUN_DATA_ADMISSAO,
						FUN_JORNADA_TRABALHO,
						FK_SUP_CNPJ)
VALUES                  ("55567890123",
						"ANA CRISTINA",
						"1995-12-30",
						"41954321098", 
						"ANA.CRISTINA@EMAIL.COM",
						"CARTEIRA_ANA_CRISTINA_.PDF",
						"6789",
						"54321",
						"2023-11-01", 
						"44 HORAS", 
						"45678901");

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("12345678", 1);

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("12345678", 2);

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("87654321", 3);

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("23456789", 4);

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("34567890", 5);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("54951633858", 1);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("12345678901", 1);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("23456789012", 3);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("34567890123", 4);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("45678901234", 5);

SELECT * FROM SUPERMERCADO;

/* CONSULTAR O AUMENTO DE R$ 2,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL >= R$ 5,00 */

SELECT  PRO_NOME          			AS "NOME",
		PRO_CODIGO_BARRAS 			AS "CODIGO DE BARRAS",
        PRO_PRECO         			AS "PREÇO ATUAL",
        TRUNCATE((PRO_PRECO + 2),2) AS "PREÇO COM AJUSTE DE R$ 2,OO"
FROM    PRODUTO
WHERE   PRO_PRECO >= 5;

/* consultar a redução de R$ 1,00 no preço dos produtos compreço atual abaixo de R$ 5,00*/

SELECT PRO_NOME           			AS "NOME",
		PRO_CODIGO_BARRAS 			AS "CODIGO DE BARRAS",
        PRO_PRECO         			AS "PREÇO ATUAL",
        TRUNCATE((PRO_PRECO - 1),2) AS "PREÇO COM REDUÇÃO DE R$ 1,00"
FROM    PRODUTO
WHERE   PRO_PRECO <= 10;

/* CONSULTAR COMO SERIA APLICAR UM DESCONTO DE 10% EM TODOS OS PRODUTOS*/

SELECT PRO_NOME           							AS "NOME",
		PRO_CODIGO_BARRAS 							AS "CODIGO DE BARRAS",
        PRO_PRECO         							AS "PREÇO ATUAL",
        TRUNCATE((PRO_PRECO - (PRO_PRECO * 0.1)),2) AS "PREÇO COM DESCONTO DE 10%"
FROM    PRODUTO;

/* AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO, DIVIDINDO PELA METADE*/

SELECT PRO_ID,
	   PRO_NOME,
	   PRO_CODIGO_BARRAS,
       PRO_QUANTIDADE
FROM   PRODUTO;

UPDATE PRODUTO
SET    PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE  PRO_ID =1;

/*CONSULTAR TODOS OS PRODUTOS QJE TENHA DATA DE VALIDADE ENTRE SETEMBRI DE 2025 E DEZEMBRO DE 2025*/

SELECT  PRO_NOME          AS "NOME",
		PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS",
		PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM    PRODUTO
WHERE 	PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';

/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM PREÇO MAIOR QUE R$10 OU MENOR QUE R$4*/

SELECT  PRO_NOME          AS"NOME",
		PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS",
        PRO_PRECO         AS "PREÇO"
FROM    PRODUTO
WHERE   PRO_PRECO >=10 OR PRO_PRECO <=4;

/*CONSULTAR OS DDS E TELEFONE DOS CONSUMIDORES SEPARADAMENTE*/

SELECT CON_NOME                    AS "NOME DO CONSUMIDOR",
	   CON_CPF                     AS "CPF DO CONSUMIDOR",
       SUBSTRING(CON_TELEFONE,1,2) AS "DDD DO TELEFONE",
       SUBSTRING(CON_TELEFONE,3,9) AS "NUMERO DO TELEFONE"
FROM   CONSUMIDOR;

/*GERAR UMA FRASE CONCATENANDO : RAZAO SOCIAL, CNPJ, TELEFONE E EMAIL*/

SELECT  CONCAT("RAZÃO SOCIAL:", 
                CONCAT(SUP_RAZAO_SOCIAL,
                       CONCAT("| CNPJ:", 
                         CONCAT(SUP_CNPJ,
							CONCAT("| TELEFONEL:", 
                               CONCAT(SUP_TELEFONE, 
                                  CONCAT("| EMAIL:", SUP_EMAIL))))))) AS FRASE
FROM 	SUPERMERCADO;

/* GERAR UMA CONSULTA QUE VERIFICA O PESO DOS PRODUTOS. RETORNAR: NOME, CODIGO DE BARRAS, QUANTIDADE, PESO E DATA DE VALIDADE
REGRAS: 1) PESO <= 5: PESO BAIXO 2) PESO > 5 E PESO <= 50: PESO MÉDIO 3) PESO > 50: PESO ALTO*/

SELECT  PRO_NOME 		  AS "NOME DO PRODUTO",
		PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS",
		PRO_QUANTIDADE    AS "QUANTIDADE",
		PRO_DATA_VALIDADE AS "DATA DE VALIDADE",
		PRO_PESO 		  AS "PESO DO PRODUTO",
		CASE
			WHEN PRO_PESO <= 5  THEN "PESO BAIXO"
			WHEN PRO_PESO > 5   AND PRO_PESO <= 50 THEN "PESO MÉDIO"
			WHEN PRO_PESO > 50  THEN "PESO ALTO"
		END AS "CLASSIFICAÇÃO DO PESO"
FROM PRODUTO;

/* CONTAR QUANTOS CONSUMIDORES TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM CONSUMIDOR;

/* CONTAR QUANTOS SUPERMERCADOS TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM SUPERMERCADO;

/* CONTAR QUANTOS FUNCIONARIOS TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM FUNCIONARIO;

/* CONTAR QUANTOS PRODUTOS TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM PRODUTO;

/* SOMAR O PREÇO TOTAL DE TODOS OS PRODTOS CADASTRADOS*/

SELECT SUM(PRO_PRECO)
FROM   PRODUTO;

SELECT CONCAT("R$", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM   PRODUTO;

/*CALCULAR A MÉDIA DE PREÇOS DOS PRODUTOS*/

SELECT  AVG(PRO_PRECO)
FROM    PRODUTO;

SELECT CONCAT("R$", TRUNCATE(AVG(PRO_PRECO),2)) AS "MEDIA DE PREÇO"
FROM   PRODUTO;

/*SELECIONAR O PRODUTO MAIS CARO*/

SELECT MAX(PRO_PRECO)
FROM   PRODUTO;

/*SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE*/

SELECT MAX(PRO_QUANTIDADE)
FROM   PRODUTO;

/*SELECIONAR O PRODUTO MAIS BARATO*/

SELECT MIN(PRO_PRECO)
FROM   PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOR QUANTIDADE*/

SELECT MIN(PRO_QUANTIDADE)
FROM   PRODUTO;

/*DATA E HORA ATUAL*/

SELECT NOW() FROM DUAL;

/**/

SELECT  FUN_NOME 									  AS "NOME DO FUNCIONARIO",
		DATE_FORMAT(FUN_DATA_NASCIMENTO, "%d/%m/%Y")  AS "DATA DE NASCIMENTO",
        TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM    FUNCIONARIO;

/*FUNÇOES MATEMATICAS: ABS - VALOR ABSOLUTO DE UM NUMERO/ ROUND - ARREDONDAR/ POWER - POTECIA*/

SELECT ABS(-10),
	   ROUND(PRO_PRECO)   AS "PREÇO ARREDONDADO",
       POWER(PRO_PRECO,2) AS "PREÇO ELEVADO AO QUADRADO"
FROM   PRODUTO;

/*UPPER, LOWER, TRIM*/

SELECT	UPPER(FUN_NOME) AS "MAIUSCULAS",
		LOWER(FUN_NOME) AS "MINUSCULAS",
        TRIM("   JULIA")AS "TIRANDO ESPAÇOS"
FROM    FUNCIONARIOS;

/*GROUP BY*/
SELECT    PRO_QUANTIDADE,
		  COUNT(*) AS "REPETIÇÕES"
FROM      PRODUTO
GROUP BY  PRO_QUANTIDADE;

/*UNION*/
SELECT  FUN_NOME,
		FUN_CPF
FROM    FUNCIONARIO
UNION
SELECT  FUN_NOME,
		FUN_CPF
FROM    FUNCIONARIO;

SELECT * FROM PRODUTO;

/*UNION*/
SELECT PRO_NOME
FROM PRODUTO
UNION
SELECT "ARROZ 5KG"
FROM DUAL
UNION
SELECT "IOGURT DO BOB ESPONJA"
FROM DUAL;

/*UNION ALL*/
SELECT PRO_NOME
FROM PRODUTO
UNION ALL
SELECT "ARROZ 5KG"
FROM DUAL
UNION ALL
SELECT "IOGURT DO BOB ESPONJA"
FROM DUAL;

/*SELECT COM WHERE*/
SELECT FUN_NOME		 						  AS "NOME DO FUNCIONARIO",
FUN_CPF 									  AS "CPF DO FUNCIONARIO",
FUN_DATA_NASCIMENTO 						  AS "DATA DE NASCIMENTO",
TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO
WHERE TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) >=25
AND TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) <=35;

/*RETORNAR OS FUNCIONARIOS,CONSUMIDORES E SUPERMERCADOS COM EMAIL IGUAL A HOTMAIL OU OUTLOOK*/

SELECT  CON_NOME 	        AS "NOME",
		CON_CPF 	        AS "CPF/CNPJ",
		CON_TELEFONE        AS "TELEFONE",
		CON_EMAIL 	        AS "EMAIL",
		"CONSUMIDOR"        AS "TIPO"
FROM	CONSUMIDOR
WHERE 	UPPER(CON_EMAIL)    LIKE "%EMAIL%"
OR 		UPPER(CON_EMAIL)    LIKE "%OUTLOOK%"
UNION
SELECT 	FUN_NOME 	        AS"NOME",
		FUN_CPF 	        AS "CPF/CNPJ",
		FUN_TELEFONE        AS "TELEFONE",
		FUN_EMAIL 	        AS "EMAIL",
        "FUNCIONARIO"       AS "TIPO"
FROM 	FUNCIONARIO
WHERE 	UPPER(FUN_EMAIL)    LIKE "%EMAIL%"
OR 		UPPER(FUN_EMAIL)    LIKE "%OUTLOOK%"
UNION
SELECT 	SUP_RAZAO_SOCIAL 	 AS "NOME",
		SUP_CNPJ 	 		 AS "CPF/CNPJ",
		SUP_TELEFONE 		 AS "TELEFONE",
		SUP_EMAIL 	         AS "EMAIL",
        "SUPERMERCADO" 		 AS "TIPO"
FROM 	SUPERMERCADO
WHERE 	UPPER(SUP_EMAIL)     LIKE "%EMAIL%"
OR 		UPPER(SUP_EMAIL)     LIKE "%OUTLOOK%";

/*CROSS JOIN:
RETORNAR TODOS OS PRODUTOS E OS SUPERMERCADOS EM QUE SÃO VENDIDOS*/

SELECT  	PRODUTO.PRO_NOME              AS "NOME",
			PRODUTO.PRO_CODIGO_BARRAS     AS "CODIGO DE BARRAS",
			SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL"
FROM		SUPERMERCADO_PRODUTO
CROSS JOIN 	SUPERMERCADO
CROSS JOIN 	PRODUTO
WHERE 		PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID
AND   		SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ;

/*INNERJOIN:
RETORNAR APENAS PRODUTOS QUE FORAM COMPRADOS POR ALGUM CONSUMIDOR*/

SELECT      PRODUTO_CONSUMIDOR.PCO_ID AS "ID DA CONTA",
		    PRODUTO.PRO_NOME 		  AS "NOME DO PRODUTO",
		    PRODUTO.PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS",
		    CONSUMIDOR.CON_NOME 	  AS "NOME DO CONSUMIDOR",
			CONSUMIDOR.CON_CPF 		  AS "CPF DO CONSUMIDOR"
FROM        PRODUTO_CONSUMIDOR
INNER JOIN  PRODUTO                   ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN  CONSUMIDOR                ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCICIO COM INNER JOIN:
RETORNAR APENAS OS FUNCIONARIOS QUE TRABALHAM EM UM SUPERMERCADO, RETORNAR O NOMEDO FUNCIONARIO E O NOME DO SUPERMERCADO QUE ELE TRABALHA*/

SELECT     FUN_NOME   		 AS "NOME FUNCIONARIO",
		   SUP_RAZAO_SOCIAL  AS "NOME MERCADO"
FROM       FUNCIONARIO 
INNER JOIN SUPERMERCADO      ON (FK_SUP_CNPJ = SUP_CNPJ);

/*EXERCICIO 02 COM INNER JOIN:
RETORNAR APENAS OS PRODUTOS QUE EXISTAM EM UM SUPERMERCADO,RETORNAR O NOME DO PRODUTO E O NOME DO SUPERMERCADO QUE ELE ESTÁ DISPONIVÉL*/

SELECT     PRODUTO.PRO_NOME 			 AS "NOME PRODUTO",
		   SUPERMERCADO.SUP_RAZAO_SOCIAL AS "NOME MERCADO"
FROM   	   SUPERMERCADO_PRODUTO 
INNER JOIN PRODUTO 						 ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID )
INNER JOIN SUPERMERCADO 				 ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ );

/*LEFT JOIN*/

INSERT INTO PRODUTO (   PRO_CODIGO_BARRAS,
						PRO_NOME,
						PRO_PESO, 
						PRO_QUANTIDADE, 
						PRO_PRECO,
						PRO_DATA_VALIDADE)
VALUES                  ("33333333",
                        "KITKAT",
                        "30",
                        "1500",
                        4.50,
                        "2026-01-01");

SELECT    PRODUTO.PRO_NOME,
		  SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM 	  PRODUTO
LEFT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMERCADO 		   ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

SELECT * FROM SUPERMERCADO;

SELECT     PRODUTO.PRO_NOME,
		   SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM 	   PRODUTO
RIGHT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMERCADO 		ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*SELECT COM LEFT E RIGHT JOIN*/

SELECT *
FROM (
		SELECT    S.SUP_RAZAO_SOCIAL 		AS RAZAO_SOCIAL,
				  F.FUN_NOME         		AS NOME_FUNCIONARIO,
                  P.PRO_NOME 		 		AS NOME_PRODUTO,
				  C.CON_NOME 		 		AS NOME_CONSUMIDOR
		FROM   	  SUPERMERCADO S
        LEFT JOIN FUNCIONARIO F 			ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        LEFT JOIN SUPERMERCADO_PRODUTO SP 	ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        LEFT JOIN PRODUTO P 				ON (SP.FK_PRO_ID = P.PRO_ID)
        LEFT JOIN PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID = PC.FK_PRO_ID)
        LEFT JOIN CONSUMIDOR C 				ON (PC.FK_CON_CPF = C.CON_CPF)
        UNION
        SELECT    S.SUP_RAZAO_SOCIAL 		AS RAZAO_SOCIAL,
				  F.FUN_NOME         		AS NOME_FUNCIONARIO,
                  P.PRO_NOME				AS NOME_PRODUTO,
				  C.CON_NOME 		 		AS NOME_CONSUMIDOR
		FROM   	  SUPERMERCADO S
        RIGHT JOIN FUNCIONARIO F 			ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        RIGHT JOIN SUPERMERCADO_PRODUTO SP 	ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        RIGHT JOIN PRODUTO P 				ON (SP.FK_PRO_ID = P.PRO_ID)
        RIGHT JOIN PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID = PC.FK_PRO_ID)
        RIGHT JOIN CONSUMIDOR C 			ON (PC.FK_CON_CPF = C.CON_CPF)
)SELECT_EXTERNO
ORDER BY  SELECT_EXTERNO.RAZAO_SOCIAL 	  ASC,
		  SELECT_EXTERNO.NOME_FUNCIONARIO DESC,
          SELECT_EXTERNO.NOME_PRODUTO 	  ASC,
          SELECT_EXTERNO.NOME_CONSUMIDOR  DESC;

/*ASSOCIAÇÃO DE TABELAS EXERCICIO 01*/

/*1*/
SELECT     PRODUTO.PRO_NOME              AS "NOME PRODUTO",
           SUPERMERCADO.SUP_RAZAO_SOCIAL AS "NOME MERCADO"
FROM       SUPERMERCADO_PRODUTO 
INNER JOIN PRODUTO                       ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID )
INNER JOIN SUPERMERCADO                  ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ );

/*2*/
SELECT     FUN_NOME   		 AS "NOME FUNCIONARIO",
		   SUP_RAZAO_SOCIAL  AS "NOME MERCADO"
FROM       FUNCIONARIO 
INNER JOIN SUPERMERCADO      ON (FK_SUP_CNPJ = SUP_CNPJ);

/*3*/
SELECT     CONSUMIDOR.CON_NOME AS "NOME CONSUMIDOR",
		   PRODUTO.PRO_NOME    AS "NOME PRODUTO"
FROM       PRODUTO_CONSUMIDOR
INNER JOIN CONSUMIDOR          ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF)
INNER JOIN PRODUTO             ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID);


/*4*/
SELECT     PRO_NOME   AS "NOME PRODUTO",
		   CON_NOME   AS "NOME CONSUMIDOR"
FROM       PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO    ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*5*/
SELECT     SUP_RAZAO_SOCIAL AS "NOME MERCADO",
		   COUNT(*)         AS "QUANTIDADE"
FROM       SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO          ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO     ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
GROUP BY   SUPERMERCADO.SUP_RAZAO_SOCIAL;

/*ASSOCIAÇÃO DE TABELAS EXERCICIO 02*/

/*1*/
SELECT    S.SUP_RAZAO_SOCIAL,
		  P.PRO_NOME
FROM 	  SUPERMERCADO S
LEFT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
LEFT JOIN PRODUTO P				  ON (P.PRO_ID = SP.FK_PRO_ID);

/*2*/
SELECT    F.FUN_NOME,
	      S.SUP_RAZAO_SOCIAL
FROM 	  FUNCIONARIO F
LEFT JOIN SUPERMERCADO S ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);

/*3*/
SELECT 	  C.CON_NOME,
		  P.PRO_NOME
FROM   	  CONSUMIDOR C
LEFT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
LEFT JOIN PRODUTO P 			ON (P.PRO_ID = PC.FK_PRO_ID);

/*4*/
SELECT 	   P.PRO_NOME,
		   C.CON_NOME
FROM   	   PRODUTO P
LEFT JOIN  PRODUTO_CONSUMIDOR PC ON (P.PRO_ID = PC.FK_PRO_ID)
LEFT JOIN  CONSUMIDOR C 		 ON (C.CON_CPF = PC.FK_CON_CPF);

/*5*/
SELECT     S.SUP_RAZAO_SOCIAL,
		   F.FUN_NOME
FROM 	   SUPERMERCADO S
LEFT JOIN  FUNCIONARIO F ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);

/*ASSOCIAÇÃO DE TABELAS EXERCICIO 03*/

/*1*/
SELECT      SUPERMERCADO.SUP_RAZAO_SOCIAL,
		    PRODUTO.PRO_NOME		  
FROM 	    SUPERMERCADO
RIGHT JOIN  SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
RIGHT JOIN  PRODUTO 		     ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID) ;

/*2*/
SELECT 	   C.CON_NOME,
		   P.PRO_NOME       
FROM       CONSUMIDOR C
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
RIGHT JOIN PRODUTO P             ON (P.PRO_ID = PC.FK_PRO_ID);

/*3*/
SELECT 	F.FUN_NOME,
		S.SUP_RAZAO_SOCIAL
FROM SUPERMERCADO S
RIGHT JOIN FUNCIONARIO F ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);

/*4*/
SELECT      SUPERMERCADO.SUP_RAZAO_SOCIAL,
		    PRODUTO.PRO_NOME		  
FROM 	    SUPERMERCADO
RIGHT JOIN  SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
RIGHT JOIN  PRODUTO 		     ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID) ;

/*5*/
SELECT 	   C.CON_NOME,
		   P.PRO_NOME       
FROM       CONSUMIDOR C
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
RIGHT JOIN PRODUTO P             ON (P.PRO_ID = PC.FK_PRO_ID);

